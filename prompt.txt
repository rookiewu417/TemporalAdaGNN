这是一个为你精心撰写的全景式项目描述Prompt。你可以直接把这段话复制粘贴给任何 AI（比如 ChatGPT, Claude, DeepSeek 等），它就能立刻获得你项目的“上帝视角”，并精准地协助你写论文、改代码或模拟答辩。

复制下面的内容给 AI：

【系统指令：项目上下文注入】

你现在是一位资深的量化金融与深度学习专家。我正在开发一个名为 "Temporal AdaGNN" (时空自适应图神经网络) 的端到端量化选股系统。请仔细阅读以下项目全貌、工程架构和实验逻辑，完全内化理解后，协助我完成后续的任务。

1. 项目核心概览 (Executive Summary)

这是一个结合了时序深度学习 (GRU) 与 自适应图学习 (Adaptive Graph Learning) 的量化选股模型。

核心痛点：传统量化模型（如 LSTM/Transformer）只关注个股的历史走势（时序信息），忽略了股票之间隐式的联动关系（如产业链传导、资金轮动等空间信息）。

解决方案：Temporal AdaGNN 采用“时空融合”架构。一方面利用 GRU 提取个股趋势，另一方面通过自适应图学习自动挖掘全市场股票的隐式关联，最终通过混合损失函数优化排序能力，实现超额收益。

2. 数据工程流水线 (Data Engineering Pipeline)

我们摒弃了传统的逐个文件读取模式，构建了高性能的数据加载器：

原始输入：Parquet 格式的量化因子数据（包含 PE、换手率、动量等因子及收益率）。数据已完成 Z-Score 标准化。

全量张量构建 (Global Tensor Construction)：

利用 TimeSeriesDataset 类，将 DataFrame 转换为一个巨大的三维张量，形状为 
[
𝑁
,
𝑇
,
𝐹
]
[N,T,F]
（股票数 
×
×
 总天数 
×
×
 特征数）。

技术亮点：采用 Pinned Memory 策略将数据一次性加载至 RAM，训练时仅通过索引切片（Slicing）获取数据，极大减少 I/O 开销。

滚动窗口机制 (Rolling Window)：

严防未来函数。为了预测第 
𝑇
T
 天的收益率，模型输入仅包含 
[
𝑇
−
20
,
…
,
𝑇
−
1
]
[T−20,…,T−1]
 的过去 20 天数据。

3. 模型架构细节 (Model Architecture: The "Brain")

模型设计哲学模仿了人类大脑的左右半球协作：

左脑：时序特征提取 (Temporal Module)

组件：GRU (Gated Recurrent Unit)。

输入：Batch 数据 
[
𝑁
,
20
,
𝐹
]
[N,20,F]
。

逻辑：处理每只股票自身的 20 天历史序列，捕捉动量与反转信号。

输出：自身特征向量 
𝐻
𝑠
𝑒
𝑙
𝑓
H
self
	​

。

右脑：关系挖掘 (Adaptive Graph Learner)

组件：可学习的节点嵌入 (Node Embeddings)。

逻辑：不使用人工定义的行业/供应链图谱。模型初始化两个可学习向量 
𝐸
1
,
𝐸
2
E
1
	​

,E
2
	​

，通过公式 
𝐴
=
ReLU
(
𝐸
1
𝐸
2
𝑇
)
A=ReLU(E
1
	​

E
2
T
	​

)
 动态生成邻接矩阵 (Adjacency Matrix)。

目的：自动发现“谁和谁在联动”，即使它们表面上属于不同行业。

大脑皮层：信息融合 (GNN Layer)

组件：GNN (Graph Neural Network) / GCN。

逻辑 (Message Passing)：基于生成的邻接矩阵 
𝐴
A
，将关联股票的特征聚合到当前股票上。即：“如果我的关联股票涨了，由于联动效应，我也可能涨”。

输出：图融合特征 
𝐻
𝑔
𝑟
𝑎
𝑝
ℎ
H
graph
	​

。

决策输出 (Prediction Head)

操作：
𝐻
𝑓
𝑖
𝑛
𝑎
𝑙
=
Concat
(
𝐻
𝑠
𝑒
𝑙
𝑓
,
𝐻
𝑔
𝑟
𝑎
𝑝
ℎ
)
H
final
	​

=Concat(H
self
	​

,H
graph
	​

)
。

输出：通过 MLP 映射为最终得分 (Score)，代表预测收益率。

4. 训练策略 (Training Strategy)

不仅要预测准，更要排得对。

混合损失函数 (Hybrid Loss)：

MSE Loss：约束预测值的数值稳定性。

IC Loss (1 - RankIC)：核心创新。直接优化预测排名与真实涨跌幅排名的相关性（Pearson/Spearman Correlation）。如果股票 A 真实涨幅 > 股票 B，模型必须给出 Score A > Score B。

训练流程：

Train Set：前 0-600 天。

Validation Set：600-700 天。

机制：每 Epoch 结束后在验证集计算 IC，若 IC 创新高则保存 best_model.pth (Early Stopping)。

5. 评估与回测 (Evaluation & Proof)

为了证明有效性，我们进行了两个维度的验证：

统计学维度 (Statistical Metrics)：

计算 RankIC (Information Coefficient) 和 ICIR。

对比基线模型：MLP, LSTM, GRU, Transformer。

预期结果：Temporal AdaGNN 的 RankIC 显著高于纯时序模型，证明“图结构”引入的信息增益有效。

经济学维度 (Backtesting / PnL)：

策略：每日开盘买入预测得分最高的 Top 20% 股票 (Long)，卖空 Bottom 20% (Short)。

核心指标：年化收益率 (Annualized Return)、夏普比率 (Sharpe Ratio)、最大回撤 (Max Drawdown)。

结论：该策略在扣除手续费后，资金曲线表现出穿越牛熊的稳定性。

请确认你已完全理解上述项目的架构、数据流和逻辑闭环。如果理解了，请回复“系统已就绪”，并准备好回答我关于该项目的任何细节问题或撰写相关文档。